(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[745],{6578:(e,s,t)=>{Promise.resolve().then(t.bind(t,9590))},9590:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var a=t(5155),l=t(2115),r=t(315),i=t(5007),c=t(7401);let n=(0,c.A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);var d=t(3239),x=t(6878);let m=(0,c.A)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);var h=t(747),o=t(9602);function u(){let[e,s]=(0,l.useState)({totalRewards:0,claimedRewards:0,distributedRewards:0,availableRewards:0,totalValue:0,claimedValue:0,claimRate:0}),[t,c]=(0,l.useState)(!0);return((0,l.useEffect)(()=>{(async()=>{try{let{data:e,error:t}=await h.N.from("rewards").select("status, reward_value");if(t)throw t;let a=e||[],l=a.filter(e=>"CLAIMED"===e.status),r=a.filter(e=>"DISTRIBUTED"===e.status),i=a.filter(e=>"AVAILABLE"===e.status),c=a.reduce((e,s)=>e+Number(s.reward_value),0),n=l.reduce((e,s)=>e+Number(s.reward_value),0),d=a.length>0?l.length/a.length*100:0;s({totalRewards:a.length,claimedRewards:l.length,distributedRewards:r.length,availableRewards:i.length,totalValue:c,claimedValue:n,claimRate:d})}catch(e){console.error("Error fetching analytics:",e)}finally{c(!1)}})()},[]),t)?(0,a.jsx)(r.N,{pageTitle:"Analytics",children:(0,a.jsx)("div",{className:"text-center",children:"Loading analytics..."})}):(0,a.jsxs)(r.N,{pageTitle:"Analytics",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("p",{className:"text-slate-600",children:"Track reward performance and metrics"})}),(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium",children:"Total Rewards"}),(0,a.jsx)(n,{className:"h-4 w-4 text-slate-500"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:e.totalRewards}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"All generated rewards"})]})]}),(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium",children:"Claimed"}),(0,a.jsx)(d.A,{className:"h-4 w-4 text-green-500"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:e.claimedRewards}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Successfully redeemed"})]})]}),(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium",children:"Distributed"}),(0,a.jsx)(x.A,{className:"h-4 w-4 text-amber-500"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:e.distributedRewards}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Given to customers"})]})]}),(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium",children:"Available"}),(0,a.jsx)(n,{className:"h-4 w-4 text-blue-500"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:e.availableRewards}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Ready to distribute"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium",children:"Total Reward Value"}),(0,a.jsx)(m,{className:"h-4 w-4 text-slate-500"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:(0,o.vv)(e.totalValue)}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Aggregate value of all rewards"})]})]}),(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium",children:"Claimed Value"}),(0,a.jsx)(m,{className:"h-4 w-4 text-green-500"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:(0,o.vv)(e.claimedValue)}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Total value redeemed"})]})]}),(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-medium",children:"Claim Rate"}),(0,a.jsx)(x.A,{className:"h-4 w-4 text-blue-500"})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsxs)("div",{className:"text-3xl font-bold",children:[e.claimRate.toFixed(1),"%"]}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Percentage of rewards claimed"})]})]})]}),(0,a.jsxs)(i.Zp,{className:"mt-6",children:[(0,a.jsx)(i.aR,{children:(0,a.jsx)(i.ZB,{children:"Reward Status Breakdown"})}),(0,a.jsx)(i.Wu,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"h-3 w-3 rounded-full bg-green-500"}),(0,a.jsx)("span",{className:"text-sm text-slate-700",children:"Claimed"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e.claimedRewards}),(0,a.jsx)("span",{className:"text-sm text-slate-500",children:(0,o.vv)(e.claimedValue)})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"h-3 w-3 rounded-full bg-amber-500"}),(0,a.jsx)("span",{className:"text-sm text-slate-700",children:"Distributed"})]}),(0,a.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e.distributedRewards})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"h-3 w-3 rounded-full bg-blue-500"}),(0,a.jsx)("span",{className:"text-sm text-slate-700",children:"Available"})]}),(0,a.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e.availableRewards})]})]})})]})]})}},315:(e,s,t)=>{"use strict";t.d(s,{N:()=>v});var a=t(5155),l=t(2115),r=t(6046),i=t(8173),c=t.n(i),n=t(6507),d=t(9110),x=t(9486),m=t(2423),h=t(3075),o=t(2823),u=t(9136),f=t(9602);let N=[{href:"/dashboard",label:"Dashboard",icon:(0,a.jsx)(n.A,{className:"h-5 w-5"}),roles:["SUPER_ADMIN","TENANT_MARKETING_ADMIN","MERCHANT_ADMIN"]},{href:"/tenants",label:"Tenants",icon:(0,a.jsx)(d.A,{className:"h-5 w-5"}),roles:["SUPER_ADMIN"]},{href:"/merchants",label:"Merchants",icon:(0,a.jsx)(x.A,{className:"h-5 w-5"}),roles:["SUPER_ADMIN"]},{href:"/events",label:"Events",icon:(0,a.jsx)(m.A,{className:"h-5 w-5"}),roles:["SUPER_ADMIN","TENANT_MARKETING_ADMIN"]},{href:"/rewards",label:"Rewards",icon:(0,a.jsx)(h.A,{className:"h-5 w-5"}),roles:["MERCHANT_ADMIN"]},{href:"/rewards/claim",label:"Claim Reward",icon:(0,a.jsx)(h.A,{className:"h-5 w-5"}),roles:["MERCHANT_ADMIN"]},{href:"/users",label:"Users",icon:(0,a.jsx)(o.A,{className:"h-5 w-5"}),roles:["SUPER_ADMIN"]},{href:"/analytics",label:"Analytics",icon:(0,a.jsx)(u.A,{className:"h-5 w-5"}),roles:["SUPER_ADMIN","TENANT_MARKETING_ADMIN","MERCHANT_ADMIN"]}];function j(e){let{userRole:s}=e,t=(0,r.usePathname)(),l=N.filter(e=>e.roles.includes(s));return(0,a.jsxs)("div",{className:"flex h-full w-64 flex-col bg-slate-800 text-white",children:[(0,a.jsx)("div",{className:"flex h-16 items-center justify-center border-b border-slate-700 px-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"rounded-lg bg-blue-600 p-2",children:(0,a.jsx)(h.A,{className:"h-6 w-6"})}),(0,a.jsx)("span",{className:"text-lg font-semibold",children:"Merchant App"})]})}),(0,a.jsx)("nav",{className:"flex-1 space-y-1 px-3 py-4",children:l.map(e=>{let s=t===e.href||(null==t?void 0:t.startsWith(e.href+"/"));return(0,a.jsxs)(c(),{href:e.href,className:(0,f.cn)("flex items-center space-x-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors",s?"bg-slate-700 text-white":"text-slate-300 hover:bg-slate-700 hover:text-white"),children:[e.icon,(0,a.jsx)("span",{children:e.label})]},e.href)})})]})}var b=t(1466),p=t(5236),w=t(4085);function g(e){let{user:s,pageTitle:t}=e,l=(0,r.useRouter)(),i=async()=>{await fetch("/api/auth/logout",{method:"POST"}),l.push("/login")};return(0,a.jsxs)("div",{className:"flex h-16 items-center justify-between border-b border-slate-200 bg-white px-6",children:[(0,a.jsx)("div",{children:t&&(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:t})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"rounded-full bg-blue-100 p-2",children:(0,a.jsx)(b.A,{className:"h-5 w-5 text-blue-600"})}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("div",{className:"font-medium text-slate-900",children:s.name}),(0,a.jsx)("div",{className:"text-slate-500",children:s.role.replace(/_/g," ")})]})]}),(0,a.jsxs)(w.$,{variant:"ghost",size:"sm",onClick:i,className:"flex items-center space-x-2",children:[(0,a.jsx)(p.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Logout"})]})]})]})}function v(e){let{children:s,pageTitle:t}=e,i=(0,r.useRouter)(),[c,n]=(0,l.useState)(null),[d,x]=(0,l.useState)(!0);return((0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/auth/me"),s=await e.json();s.success&&s.user?n(s.user):i.push("/login")}catch(e){i.push("/login")}finally{x(!1)}})()},[i]),d)?(0,a.jsx)("div",{className:"flex h-screen items-center justify-center bg-slate-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-blue-600 border-t-transparent mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-slate-600",children:"Loading..."})]})}):c?(0,a.jsxs)("div",{className:"flex h-screen bg-slate-50",children:[(0,a.jsx)(j,{userRole:c.role}),(0,a.jsxs)("div",{className:"flex flex-1 flex-col overflow-hidden",children:[(0,a.jsx)(g,{user:c,pageTitle:t}),(0,a.jsx)("main",{className:"flex-1 overflow-y-auto p-6",children:s})]})]}):null}},4085:(e,s,t)=>{"use strict";t.d(s,{$:()=>i});var a=t(5155),l=t(2115),r=t(9602);let i=l.forwardRef((e,s)=>{let{className:t,variant:l="primary",size:i="md",...c}=e;return(0,a.jsx)("button",{className:(0,r.cn)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus-visible:ring-blue-600",secondary:"border border-slate-200 bg-transparent text-slate-700 hover:bg-slate-100 focus-visible:ring-slate-400",danger:"bg-red-500 text-white hover:bg-red-600 focus-visible:ring-red-500",ghost:"bg-transparent text-slate-500 hover:bg-slate-100 focus-visible:ring-slate-400"}[l],{sm:"h-9 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-11 px-8 text-lg"}[i],t),ref:s,...c})});i.displayName="Button"},5007:(e,s,t)=>{"use strict";t.d(s,{BT:()=>d,Wu:()=>x,ZB:()=>n,Zp:()=>i,aR:()=>c});var a=t(5155),l=t(2115),r=t(9602);let i=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("rounded-lg border border-slate-200 bg-white shadow-sm",t),...l})});i.displayName="Card";let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",t),...l})});c.displayName="CardHeader";let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("h3",{ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",t),...l})});n.displayName="CardTitle";let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("p",{ref:s,className:(0,r.cn)("text-sm text-slate-500",t),...l})});d.displayName="CardDescription";let x=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("p-6 pt-0",t),...l})});x.displayName="CardContent",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",t),...l})}).displayName="CardFooter"},747:(e,s,t)=>{"use strict";t.d(s,{N:()=>a});let a=(0,t(838).UU)("https://rovlqyyjsfksgqbmxkwc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJvdmxxeXlqc2Zrc2dxYm14a3djIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI4ODU1OTgsImV4cCI6MjA3ODQ2MTU5OH0.RDqUziNPvtHu3rENURDu4pVE6fNnMh9wUgIQ-eZpSoQ")},9602:(e,s,t)=>{"use strict";t.d(s,{Yq:()=>c,cn:()=>r,qY:()=>d,r6:()=>n,vv:()=>i});var a=t(3463),l=t(9795);function r(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,l.QP)((0,a.$)(s))}function i(e){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(e)}function c(e){return new Intl.DateTimeFormat("en-IN",{year:"numeric",month:"short",day:"numeric"}).format(new Date(e))}function n(e){return new Intl.DateTimeFormat("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(e))}function d(e){return({ACTIVE:"bg-green-100 text-green-800",INACTIVE:"bg-gray-100 text-gray-800",DRAFT:"bg-gray-100 text-gray-800",EXPIRED:"bg-red-100 text-red-800",CANCELLED:"bg-red-100 text-red-800",AVAILABLE:"bg-green-100 text-green-800",DISTRIBUTED:"bg-amber-100 text-amber-800",CLAIMED:"bg-blue-100 text-blue-800"})[e]||"bg-gray-100 text-gray-800"}},3239:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(7401).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6878:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(7401).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[946,749,441,517,358],()=>s(6578)),_N_E=e.O()}]);