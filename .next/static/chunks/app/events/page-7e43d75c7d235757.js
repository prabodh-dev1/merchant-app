(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[634],{5941:(e,s,t)=>{Promise.resolve().then(t.bind(t,7990))},7990:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var a=t(5155),r=t(2115),l=t(8173),n=t.n(l),i=t(315),c=t(5007),d=t(4085),x=t(9286),m=t(3473),o=t(2423);let h=(0,t(7401).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var u=t(3580),f=t(747),N=t(9602);function p(){let[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{(async()=>{try{let{data:e,error:t}=await f.N.from("marketing_events").select("\n            *,\n            tenant:tenants(name),\n            merchant:merchants(name, code)\n          ").order("created_at",{ascending:!1});if(t)throw t;s(e||[])}catch(e){console.error("Error fetching events:",e)}finally{l(!1)}})()},[]),t)?(0,a.jsx)(i.N,{pageTitle:"Marketing Events",children:(0,a.jsx)("div",{className:"text-center",children:"Loading events..."})}):(0,a.jsxs)(i.N,{pageTitle:"Marketing Events",children:[(0,a.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-slate-600",children:"Manage marketing events and reward campaigns"})}),(0,a.jsx)(n(),{href:"/events/new",children:(0,a.jsxs)(d.$,{className:"flex items-center space-x-2",children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Create Event"})]})})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsx)(c.aR,{children:(0,a.jsx)(c.ZB,{children:"All Events"})}),(0,a.jsx)(c.Wu,{children:0===e.length?(0,a.jsxs)("div",{className:"py-12 text-center text-slate-500",children:[(0,a.jsx)(o.A,{className:"mx-auto h-12 w-12 text-slate-300"}),(0,a.jsx)("p",{className:"mt-4",children:"No events found. Create your first event to get started."}),(0,a.jsx)(n(),{href:"/events/new",children:(0,a.jsx)(d.$,{className:"mt-4",children:"Create Event"})})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"border-b border-slate-200 bg-slate-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-900",children:"Event Name"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-900",children:"Merchant"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-900",children:"Status"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-900",children:"Rewards"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-900",children:"Period"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-900",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-slate-200",children:e.map(e=>{var s;return(0,a.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-sm font-medium text-slate-900",children:e.name}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-slate-600",children:null===(s=e.merchant)||void 0===s?void 0:s.name}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)(x.E,{status:e.status,children:e.status})}),(0,a.jsxs)("td",{className:"px-4 py-3 text-sm text-slate-600",children:[e.total_rewards," rewards",(0,a.jsx)("br",{}),(0,a.jsxs)("span",{className:"text-xs text-slate-500",children:[(0,N.vv)(Number(e.min_reward_value))," - ",(0,N.vv)(Number(e.max_reward_value))]})]}),(0,a.jsxs)("td",{className:"px-4 py-3 text-sm text-slate-600",children:[(0,N.Yq)(e.start_date),(0,a.jsx)("br",{}),(0,a.jsxs)("span",{className:"text-xs text-slate-500",children:["to ",(0,N.Yq)(e.end_date)]})]}),(0,a.jsx)("td",{className:"px-4 py-3 text-right",children:(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(n(),{href:"/events/".concat(e.id),children:(0,a.jsx)(d.$,{variant:"ghost",size:"sm",children:(0,a.jsx)(h,{className:"h-4 w-4"})})}),"DRAFT"===e.status&&(0,a.jsx)(n(),{href:"/events/".concat(e.id,"/edit"),children:(0,a.jsx)(d.$,{variant:"ghost",size:"sm",children:(0,a.jsx)(u.A,{className:"h-4 w-4"})})})]})})]},e.id)})})]})})})]})]})}},315:(e,s,t)=>{"use strict";t.d(s,{N:()=>y});var a=t(5155),r=t(2115),l=t(6046),n=t(8173),i=t.n(n),c=t(6507),d=t(9110),x=t(9486),m=t(2423),o=t(3075),h=t(2823),u=t(9136),f=t(9602);let N=[{href:"/dashboard",label:"Dashboard",icon:(0,a.jsx)(c.A,{className:"h-5 w-5"}),roles:["SUPER_ADMIN","TENANT_MARKETING_ADMIN","MERCHANT_ADMIN"]},{href:"/tenants",label:"Tenants",icon:(0,a.jsx)(d.A,{className:"h-5 w-5"}),roles:["SUPER_ADMIN"]},{href:"/merchants",label:"Merchants",icon:(0,a.jsx)(x.A,{className:"h-5 w-5"}),roles:["SUPER_ADMIN"]},{href:"/events",label:"Events",icon:(0,a.jsx)(m.A,{className:"h-5 w-5"}),roles:["SUPER_ADMIN","TENANT_MARKETING_ADMIN"]},{href:"/rewards",label:"Rewards",icon:(0,a.jsx)(o.A,{className:"h-5 w-5"}),roles:["MERCHANT_ADMIN"]},{href:"/rewards/claim",label:"Claim Reward",icon:(0,a.jsx)(o.A,{className:"h-5 w-5"}),roles:["MERCHANT_ADMIN"]},{href:"/users",label:"Users",icon:(0,a.jsx)(h.A,{className:"h-5 w-5"}),roles:["SUPER_ADMIN"]},{href:"/analytics",label:"Analytics",icon:(0,a.jsx)(u.A,{className:"h-5 w-5"}),roles:["SUPER_ADMIN","TENANT_MARKETING_ADMIN","MERCHANT_ADMIN"]}];function p(e){let{userRole:s}=e,t=(0,l.usePathname)(),r=N.filter(e=>e.roles.includes(s));return(0,a.jsxs)("div",{className:"flex h-full w-64 flex-col bg-slate-800 text-white",children:[(0,a.jsx)("div",{className:"flex h-16 items-center justify-center border-b border-slate-700 px-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"rounded-lg bg-blue-600 p-2",children:(0,a.jsx)(o.A,{className:"h-6 w-6"})}),(0,a.jsx)("span",{className:"text-lg font-semibold",children:"Merchant App"})]})}),(0,a.jsx)("nav",{className:"flex-1 space-y-1 px-3 py-4",children:r.map(e=>{let s=t===e.href||(null==t?void 0:t.startsWith(e.href+"/"));return(0,a.jsxs)(i(),{href:e.href,className:(0,f.cn)("flex items-center space-x-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors",s?"bg-slate-700 text-white":"text-slate-300 hover:bg-slate-700 hover:text-white"),children:[e.icon,(0,a.jsx)("span",{children:e.label})]},e.href)})})]})}var j=t(1466),b=t(5236),v=t(4085);function g(e){let{user:s,pageTitle:t}=e,r=(0,l.useRouter)(),n=async()=>{await fetch("/api/auth/logout",{method:"POST"}),r.push("/login")};return(0,a.jsxs)("div",{className:"flex h-16 items-center justify-between border-b border-slate-200 bg-white px-6",children:[(0,a.jsx)("div",{children:t&&(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:t})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"rounded-full bg-blue-100 p-2",children:(0,a.jsx)(j.A,{className:"h-5 w-5 text-blue-600"})}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("div",{className:"font-medium text-slate-900",children:s.name}),(0,a.jsx)("div",{className:"text-slate-500",children:s.role.replace(/_/g," ")})]})]}),(0,a.jsxs)(v.$,{variant:"ghost",size:"sm",onClick:n,className:"flex items-center space-x-2",children:[(0,a.jsx)(b.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Logout"})]})]})]})}function y(e){let{children:s,pageTitle:t}=e,n=(0,l.useRouter)(),[i,c]=(0,r.useState)(null),[d,x]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/auth/me"),s=await e.json();s.success&&s.user?c(s.user):n.push("/login")}catch(e){n.push("/login")}finally{x(!1)}})()},[n]),d)?(0,a.jsx)("div",{className:"flex h-screen items-center justify-center bg-slate-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-blue-600 border-t-transparent mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-slate-600",children:"Loading..."})]})}):i?(0,a.jsxs)("div",{className:"flex h-screen bg-slate-50",children:[(0,a.jsx)(p,{userRole:i.role}),(0,a.jsxs)("div",{className:"flex flex-1 flex-col overflow-hidden",children:[(0,a.jsx)(g,{user:i,pageTitle:t}),(0,a.jsx)("main",{className:"flex-1 overflow-y-auto p-6",children:s})]})]}):null}},9286:(e,s,t)=>{"use strict";t.d(s,{E:()=>l});var a=t(5155);t(2115);var r=t(9602);function l(e){let{className:s,status:t,children:l,...n}=e,i=t?(0,r.qY)(t):"";return(0,a.jsx)("div",{className:(0,r.cn)("inline-flex items-center rounded-full px-3 py-1 text-xs font-medium",i,s),...n,children:l||t})}},4085:(e,s,t)=>{"use strict";t.d(s,{$:()=>n});var a=t(5155),r=t(2115),l=t(9602);let n=r.forwardRef((e,s)=>{let{className:t,variant:r="primary",size:n="md",...i}=e;return(0,a.jsx)("button",{className:(0,l.cn)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus-visible:ring-blue-600",secondary:"border border-slate-200 bg-transparent text-slate-700 hover:bg-slate-100 focus-visible:ring-slate-400",danger:"bg-red-500 text-white hover:bg-red-600 focus-visible:ring-red-500",ghost:"bg-transparent text-slate-500 hover:bg-slate-100 focus-visible:ring-slate-400"}[r],{sm:"h-9 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-11 px-8 text-lg"}[n],t),ref:s,...i})});n.displayName="Button"},5007:(e,s,t)=>{"use strict";t.d(s,{BT:()=>d,Wu:()=>x,ZB:()=>c,Zp:()=>n,aR:()=>i});var a=t(5155),r=t(2115),l=t(9602);let n=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border border-slate-200 bg-white shadow-sm",t),...r})});n.displayName="Card";let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...r})});i.displayName="CardHeader";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});c.displayName="CardTitle";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,l.cn)("text-sm text-slate-500",t),...r})});d.displayName="CardDescription";let x=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",t),...r})});x.displayName="CardContent",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter"},747:(e,s,t)=>{"use strict";t.d(s,{N:()=>a});let a=(0,t(838).UU)("https://rovlqyyjsfksgqbmxkwc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJvdmxxeXlqc2Zrc2dxYm14a3djIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI4ODU1OTgsImV4cCI6MjA3ODQ2MTU5OH0.RDqUziNPvtHu3rENURDu4pVE6fNnMh9wUgIQ-eZpSoQ")},9602:(e,s,t)=>{"use strict";t.d(s,{Yq:()=>i,cn:()=>l,qY:()=>d,r6:()=>c,vv:()=>n});var a=t(3463),r=t(9795);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.QP)((0,a.$)(s))}function n(e){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(e)}function i(e){return new Intl.DateTimeFormat("en-IN",{year:"numeric",month:"short",day:"numeric"}).format(new Date(e))}function c(e){return new Intl.DateTimeFormat("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(e))}function d(e){return({ACTIVE:"bg-green-100 text-green-800",INACTIVE:"bg-gray-100 text-gray-800",DRAFT:"bg-gray-100 text-gray-800",EXPIRED:"bg-red-100 text-red-800",CANCELLED:"bg-red-100 text-red-800",AVAILABLE:"bg-green-100 text-green-800",DISTRIBUTED:"bg-amber-100 text-amber-800",CLAIMED:"bg-blue-100 text-blue-800"})[e]||"bg-gray-100 text-gray-800"}},3580:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(7401).A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},3473:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(7401).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[946,749,441,517,358],()=>s(5941)),_N_E=e.O()}]);